# Colorado Wastewater Analysis, 2024-2025

## Comparing the use of mobile device data and flow data to characterize dynamic populations in wastewater surveillance monitoring areas

In this study, we evaluated the use of mobile device and flow data to characterize population fluctuations in a large network of wastewater monitoring areas, and investigated the relationships between device counts and flow rates. We use data from Colorado, USA, where wastewater reporting has been a major component of infectious disease surveillance, with a network of over 70 wastewater monitoring areas, henceforth referred to as sewersheds, reporting water usage and concentrations of SARS-CoV-2, influenza, respiratory syncytial virus (RSV), mpox, and enterovirus D68 to the Colorado Department of Public Health & Environment (CDPHE). Specifically, we used clustering approaches to classify sewersheds by distinct mobility dynamics, and evaluated whether device counts and flow rates could capture short- and medium-term population fluctuations in sewersheds in each of these clusters. Additionally, we characterized how device counts and flow rates correlated over time, and determined whether periods of decoupling could be explained by snowmelt or rainfall. Together, these analyses can set the stage for establishing methods to characterize dynamic populations in large networks of wastewater monitoring areas over short and long timescales.

### Data Sources

#### Mobile devices

We used mobile device data to characterize population dynamics in Colorado sewersheds using the US neighborhood patterns dataset obtained from Advan, via Dewey Data. This dataset describes the movement of devices between origin and destination census block groups (CBGs) over time. Device pings, primarily from cell phones, are collected using a software development kit used by smartphone applications to obtain location information of the phone. Phones can be located through a variety of methods, including GPS, network information, IP address, and Bluetooth. All data is anonymized and aggregated to the CBG level, with added measures to further protect privacy. The dataset begins on January 01, 2018 and uses the 2010 CBG boundaries for Colorado.

We estimated the mobile device count by month for each sewershed using the neighborhood patterns dataset. This dataset provides a count of total unique devices by month that enter all destination CBGs in the state from all origin CBGs associated with these unique devices, counted as one device per destination CBG per month. The distribution of origin CBGs across all devices entering each destination CBG is also provided. Advan assigns origin CBGs27 to each device in the data by analyzing six weeks of movement and determining the CBG in which a device spends most of its nighttime hours, defined as the time between 6pm and 7am. Internal devices were defined by summing, for all destination CBGs assigned to that sewershed, the monthly counts of devices whose origin CBGs matched their destination CBGs. External devices were defined by summing, for all destination CBGs assigned to that sewershed, the monthly counts of devices whose origin CBG was outside the sewershed. Devices whose origin CBG did not match the destination CBG, but still belonged to the same sewershed as the destination CBG, were excluded from the device count because these devices were already accounted for in the data. We aggregated monthly device counts to the sewershed level by combining the monthly internal and external device counts for all destination CBGs assigned to each sewershed.

We estimated daily mobile device counts for each sewershed using a different feature in the neighborhood patterns dataset. In addition to monthly total device counts, this dataset also contains device counts to a destination CBG for each day of the month, counted as one device per destination CBG per day. Daily device counts include both devices that reside in the destination CBG and devices entering from outside the destination CBG; device origin CBGs are not provided at this timestep. We calculated daily total device counts for each sewershed by summing all daily device counts for all destination CBGs assigned to that sewershed.

#### Sewershed boundaries

We obtained boundaries for 71 sewersheds in Colorado that have participated in the state’s wastewater surveillance program, provided by CDPHE. To join mobile device data to these sewersheds, we overlaid the sewershed area shapefile with the Colorado 2010 census block group (CBG) boundaries from the TIGER/Line Shapefiles from the US Census Bureau28 in ArcGIS Pro 3.3 and calculated the areal overlap between a sewershed and any CBG it occupied. If a CBG was occupied by more than one sewershed, the sewershed that occupied the highest percentage of the CBG’s land mass was assigned to that CBG. To ensure that each sewershed was assigned to at least one CBG, we assigned a CBG to a sewershed if the sewershed occupied at least 0.2% of the CBG’s land mass. 

#### Flow

We obtained flow data for 82 sewersheds in Colorado that reported viral concentrations and flow rates between August 02, 2020 and December 30, 2024, provided by the utilities via CDPHE. Flow rate describes the volume of influent water to sewersheds for a given day over time in millions of gallons per day (mgd). Flow was typically reported twice per week, although the frequency of reporting varied by sewershed. Date ranges for reporting also varied by sewershed.

Precipitation. We used the GridMET database to obtain minimum temperature, maximum temperature, and precipitation (in millimeters of water) at the county-day level from August 02, 2020 to December 30, 2024. We estimated the daily temperature for each county as the mean of the maximum and minimum temperatures. We noted precipitation as snow accumulation if the mean temperature on a given day was below 0° C. Snowmelt was calculated as follows using the degree-day method from the USDA Hydrology and National Engineering Handbook when average temperature was above 0° C and snow accumulation was present. Once total accumulation in a county reached 0mm, snowmelt values were imputed as zero. Rainfall and snowmelt were compiled for each county-day and assigned to sewersheds based on the county in which the sewershed address was located.

### Study sample and exclusion criteria

We restricted our analysis to 66 sewersheds that had both sewershed boundaries and flow data, and reported over a period of 365 days or longer. Analyses were conducted for the period from August 02, 2020 to December 30, 2024, when both mobile device and flow data were available.

### Statistical analysis

#### Analysis 1: Mobility clusters

Given the variety of urban, rural, and resort communities represented throughout the state of Colorado, we first evaluated evidence of geographical patterns in mobility dynamics for the 66 sewersheds in this study. To do this, we used K-Means clustering. The clustering algorithm assigns each sample to one of K clusters, based on the sample’s distance to each cluster’s centroid, or average sample. The centroids for each cluster are then recomputed using the new cluster assignments. This process of cluster assignment and centroid computation continues iteratively until the cluster assignments stabilize (convergence). The only parameter required for K-Means is K, which defines the number of clusters. To find the optimal K, we utilized the silhouette metric, which tests how well the pairwise distances between the points in the data align with cluster labels. We applied the algorithm on log-transformed monthly device counts and z-score normalized each sewershed’s time series temporally to ensure that the clusters represented relative patterns of mobility rather than differences in absolute device counts. 

#### Analysis 2: Fluctuations in device counts and flow rates

Using visual comparison and statistical analysis, we evaluated whether there was evidence of short- and medium-term fluctuations in device counts and flow rates in the sewershed mobility clusters generated in the previous analysis. For mobile device data, we calculated summary statistics for each sewershed cluster as a pooled median and interquartile range (IQR) of total (i.e., combined internal and external) device counts over three temporal groupings (day of the week, month, and year). For device counts by day of the week, we used daily data; for device counts by month and year, we used monthly data. For flow data, we calculated summary statistics for each sewershed cluster as a pooled median and IQR of flow rates over two temporal groupings (month and year). Day of the week was excluded in flow analyses as most sewersheds reported flow data only twice per week. 

To investigate the significance of temporal grouping on device counts, we performed linear mixed regression modeling with a fixed effect for day of the week, weekday/weekend, month, season, or year, and a random intercept for sewershed to account for repeated measures. Separate models were run for each combination of mobility cluster and temporal grouping for a total of ten models. Due to high right-skewness, we log-transformed the mobile device data and tested visually for normality. When investigating the effect of day of the week or weekday/weekend, we used daily mobile device data; for the effect of month, season, and year, we used monthly mobile device data. To protect privacy, some sewersheds reported a device count of zero on certain days; these values were imputed as 1. Because external device counts had a higher degree of fluctuation than internal device counts, we conducted a sensitivity analysis on log-transformed internal devices only. We repeated this analysis for flow rates on month, season, and year for each sewershed cluster for a total of six models. Day of the week and weekday/weekend temporal groupings were excluded because most sewersheds reported flow data only twice per week, and weekend reporting was rare. Due to high right-skewness, we log-transformed the flow data and tested visually for normality. Flow rates with a value of zero were offset to 0.001 before log-transforming. Goodness of fit for each model was assessed using likelihood ratio tests against a baseline model with no fixed effects. Analysis was performed in R version 4.2.0 using the lme4 package.

#### Analysis 3: Comparison of mobile device data to flow data

To characterize the relationship between mobile device data and flow data in each sewershed cluster throughout the year, we estimated Spearman correlation coefficients between device counts and flow rates across each combination of month and sewershed cluster. We visually compared these correlation values to the mean daily snowmelt and mean daily rainfall for each combination of month and sewershed cluster. When generating correlation coefficients, we included only complete observations that had values for both device count and flow rate; when computing mean daily snowmelt and mean daily rainfall, we used all observations.

In addition, we were interested in the strength and stability between mobile device data and flow data in each individual sewershed at finer temporal steps over longer timescales. We estimated dynamic Spearman correlations between device counts and flow rates over a 90-day rolling window using the NonParRolCor package in R, restricting the date range of each sewershed’s combined time series to begin on the date of the first non-missing value of the sewershed’s flow time series. If the flow time series ended earlier than the mobile device time series, the mobile device time series was cleaved to match the date of the final non-missing observation of the flow time series. If the flow time series ended later than the mobile device time series, the flow time series was cleaved to December 30, 2024 to match the end date of the mobile device time series. To achieve a daily timestep for flow data, missing values were filled with the previous non-missing value. No missing values existed for mobile device data. To reduce noise, both mobile device and flow data were converted into a right-justified 7-day moving average. For comparison in NonParRolCor, both time series were z-score normalized. We summarized the results in a 2x2 table for each sewershed cluster based on strength and stability. High strength was defined as a correlation value of > 0.7 for > 10% of the total observations across the entire time series; low strength was defined as a correlation value of > 0.7 for < 10% of the total observations across the entire time series. High stability was defined as the absolute value of the coefficient of variation < 1 using all observations in the time series; low stability was defined as the absolute value of the coefficient of variation > 1 using all observations in the time series.

To assess the relationship between the effect of device counts on flow rates in the 66 sewersheds from the above analysis, accounting for the role of snowmelt and rainfall, we performed multiple linear mixed regression analysis. We used complete observations for daily mobile device data, daily snowmelt and rainfall data, and flow data and summed all values for each variable by week. Due to high right-skewness, both mobile device and flow data were log-transformed. Due to variation in the proportion of true devices captured by Advan each year, all models included year as a covariate. In addition, to account for autocorrelation, all models included a one-week lagged flow rate term. We ran a full model for each sewershed cluster using Bound Optimization BY Quadratic Approximation (BOBYQA) approximation, incorporating fixed effects of log-transformed summed device counts, year, log-transformed summed flow rate from the prior week, summed rainfall, summed snowmelt, and year with a random intercept for sewershed and a random slope for log-transformed summed device counts. To account for possible differences in the relationship between precipitation and flow rate by sewersheds within a cluster, we also ran an expanded model for each cluster, adding a random slope for summed snowmelt and summed rainfall. For each cluster, we assessed the significance of the beta coefficients in the full model and compared the BIC to that of the expanded model to assess any between-sewershed differences in the effect of snowmelt and rainfall on the association between device counts and flow rates. Analysis was performed in R version 4.2.0 using the lmerTest package.

